{{define "nav"}}
<li>
    <a href='#diagram'>
        <i class="fas fa-project-diagram"></i>
        Diagram
    </a>
</li>
<li>
    <a href='#tableList'>
        <i class="fas fa-list"></i>
        Table List</a>
</li>
<li>
    <a href='#foreignKeys'>
        <i class="fas fa-exchange-alt"></i>
        Foreign Keys</a>
</li>
{{end}}

{{define "content"}}

<h2 id="diagram">Database Diagram</h2>
{{template "_diagram" .Diagram}}

<h2 id="tableList">Table List</h2>
<table class="tableList clicky-cells">
    <thead>
    <tr>
        <th>Name</th>
        <th>Rows</th>
        <th>Columns</th>
        <th>Fks</th>
        <th>Indexes</th>
        {{if $.Database.Supports.Descriptions}}
        <th>Description</th>
        {{end}}
    </tr>
    </thead>
    <tbody>
{{range .Database.Tables}}
        <tr>
            <td><a href='tables/{{.}}?_rowLimit=100'>{{.}}</a></td>
            <td><a href='tables/{{.}}?_rowLimit=100#data'>{{.RowCount}}</a></td>
            <td><a href='tables/{{.}}?_rowLimit=100#columns'>{{len .Columns}}</a></td>
            <td>
            {{if .Fks}}
                <a href='tables/{{.}}?_rowLimit=100#foreignKeys'>{{len .Fks}}</a>
            {{end}}
            </td>
            <td>
            {{if .Indexes}}
                <a href='tables/{{.}}?_rowLimit=100#indexes'>{{len .Indexes}}</a>
            {{end}}
            </td>
            {{if $.Database.Supports.Descriptions}}
            <td><span class="bare-value">{{.Description}}</span></td>
            {{end}}
        </tr>
{{end}}
    </tbody>
</table>

<h2 id="foreignKeys">Foreign Keys</h2>
<table class="clicky-cells">
    <thead>
    <tr>
        {{if $.Database.Supports.FkNames}}
        <th>Name</th>
        {{end}}
        <th>From</th>
        <th>To</th>
    </tr>
    </thead>
    <tbody>
    {{range .Database.Fks}}
    <tr>
        {{if $.Database.Supports.FkNames}}
        <td>{{.Name}}</td>
        {{end}}
        <td>
            <a href="tables/{{.SourceTable}}?_rowLimit=100">
                {{.SourceTable}}({{.SourceColumns}})
            </a>
        </td>
        <td>
            <a href="tables/{{.DestinationTable}}?_rowLimit=100">
                {{.DestinationTable}}({{.DestinationColumns}})
            </a>
        </td>
    </tr>
    {{end}}
    </tbody>
</table>

<h2 id="indexes">Indexes</h2>

<div class="fk-list">
{{if .Database.Indexes}}
    <table class="clicky-cells">
        <thead>
        <tr>
            <th>Table</th>
            <th>Name</th>
            <th>Columns</th>
            <th>Unique</th>
        </tr>
        </thead>
        <tbody>
        {{range .Database.Indexes}}
        <tr>
            <td><span class="bare-value">{{.Table}}</span></td>
            <td><span class="bare-value">{{.Name}}</span></td>
            <td><span class="bare-value">{{.Columns.String}}</span></td>
            <td>
            {{if .IsUnique }}
                <span class="bare-value">Unique</span>
            {{end}}
            </td>
        </tr>
        {{end}}
        </tbody>
    </table>
</div>
{{end}}
{{end}}
